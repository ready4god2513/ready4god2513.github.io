"use strict";var app=angular.module("vine",["ngResource","ngRoute"]);app.config(["$routeProvider",function(a){a.when("/vine",{templateUrl:"/views/vine.html",controller:"VineController"}).when("/instagram",{templateUrl:"/views/instagram.html",controller:"InstagramController"}).otherwise({redirectTo:"/vine"})}]),app.controller("InstagramController",["$scope","$timeout","Instagram",function(a,b,c){a.pics=[],a.tag="fail",a.loading=!1;var d=!1;a.loadPics=function(){a.loading=!0,c.search(a.tag,function(b){a.loading=!1,a.pics=b})},a.$watch("tag",function(){d&&b.cancel(d),d=b(function(){a.loadPics()},250)})}]),app.factory("Vine",["$http",function(a){var b="http://bhvine.herokuapp.com";return{search:function(c,d,e){a.jsonp(b+"/search/"+c+"?page="+d+"&callback=JSON_CALLBACK").success(function(a){e(a.data)})},channel:function(c,d,e){a.jsonp(b+"/recent/"+c+"?page="+d+"&callback=JSON_CALLBACK").success(function(a){e(a.data)})},channels:function(c){a.jsonp(b+"/channels?callback=JSON_CALLBACK").success(function(a){c(a.data)})}}}]),app.factory("Instagram",["$http",function(a){return{search:function(b,c){var d="https://api.instagram.com/v1/tags/"+b+"/media/recent?client_id=642176ece1e7445e99244cec26f4de1f&callback=JSON_CALLBACK";a.jsonp(d).success(function(a){c(a.data)})}}}]),app.controller("VineController",["$scope","$timeout","Vine",function(a,b,c){a.videos=[],a.loading=!1,a.searchTerm="fail",a.page=1,a.categories=[],a.category=null;var d=!1;a.searchVids=function(){ga("send","pageview","vine/"+a.searchTerm),a.searchTerm?(a.loading=!0,a.category?c.channel(a.category.featuredChannelId,a.page,function(b){a.videos.push.apply(a.videos,b.records),a.loading=!1}):c.search(a.searchTerm,a.page,function(b){a.videos.push.apply(a.videos,b.records),a.loading=!1})):a.videos=[]},a.loadCategories=function(){c.channels(function(b){a.categories=b.records})},a.loadMore=function(){a.page++,a.searchVids()},a.toggleVideo=function(a){var b=document.getElementById("vine-"+a.postId);b.getAttribute("src")||(b.setAttribute("src",a.videoUrl),b.play()),b.addEventListener("click",function(){b.paused?b.play():b.pause()})},a.$watch("searchTerm",function(){d&&b.cancel(d),d=b(function(){a.videos=[],a.searchVids()},250)}),a.$watch("category",function(){d&&b.cancel(d),d=b(function(){a.videos=[],a.searchVids()},250)})}]);