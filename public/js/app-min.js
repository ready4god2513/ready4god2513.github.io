"use strict";var app=angular.module("vine",["ngResource","ngRoute"]);app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"/views/videos.html",controller:"VideoController"})}]),app.controller("VideoController",["$scope","$timeout","VineSearch","VinePopular","VineRecent","VineChannels",function(a,b,c,d,e,f){a.videos=[],a.loading=!1,a.searchTerm="fail",a.page=1,a.categories=[],a.category=null;var g=!1;a.searchVids=function(){ga("send","pageview","vine/"+a.searchTerm),a.searchTerm?(a.loading=!0,a.category?e.get({tag:a.category.featuredChannelId,page:a.page},function(b){a.videos.push.apply(a.videos,b.data.records),a.loading=!1,console.log(b.data.records)}):c.get({tag:a.searchTerm,page:a.page},function(b){a.videos.push.apply(a.videos,b.data.records),a.loading=!1})):a.videos=[]},a.loadCategories=function(){f.get({},function(b){a.categories=b.data.records})},a.loadMore=function(){a.page++,a.searchVids()},a.toggleVideo=function(a){var b=document.getElementById("vine-"+a.postId);b.getAttribute("src")||(b.setAttribute("src",a.videoUrl),b.play()),b.addEventListener("click",function(){b.paused?b.play():b.pause()})},a.$watch("searchTerm",function(){g&&b.cancel(g),g=b(function(){a.videos=[],a.searchVids()},250)}),a.$watch("category",function(){g&&b.cancel(g),g=b(function(){a.videos=[],a.searchVids()},250)})}]),app.factory("VineSearch",["$resource",function(a){return a("http://bhvine.herokuapp.com/search/:tag",{tag:"search",callback:"JSON_CALLBACK"},{get:{method:"JSONP"}})}]),app.factory("VinePopular",["$resource",function(a){return a("http://bhvine.herokuapp.com/popular",{tag:"search",callback:"JSON_CALLBACK"},{get:{method:"JSONP"}})}]),app.factory("VineRecent",["$resource",function(a){return a("http://bhvine.herokuapp.com/recent/:tag",{tag:"search",callback:"JSON_CALLBACK"},{get:{method:"JSONP"}})}]),app.factory("VineChannels",["$resource",function(a){return a("http://bhvine.herokuapp.com/channels",{tag:"search",callback:"JSON_CALLBACK"},{get:{method:"JSONP"}})}]);